<!DOCTYPE html>
<html>
<head>
    <title>Fitness Pacer</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; font-size: 24px; } /* Increased font size */
        .exercise { margin-bottom: 20px; }
        .button { margin: 10px; font-size: 24px; }
        #timer { font-size: 36px; margin-top: 20px; }
        #calendar { margin-top: 20px; }
        ul { font-size: 24px; }
    </style>
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.0.2/main.min.css" rel="stylesheet" />
</head>
<body>
    <h1>Fitness Pacer</h1>
    
    <!-- Workout Creator -->
    <div id="workout-creator">
        <h2>Create Your Workout</h2>
        <div id="exercises"></div>
        <button onclick="addExercise()">Add Another Exercise</button>
        <button onclick="saveWorkout()">Save Workout</button>
        <button onclick="startWorkout()">Start Workout</button>
        <div id="saved-workouts">
            <h3>Saved Workouts</h3>
            <ul id="workout-list"></ul>
        </div>
    </div>

    <!-- Workout Tracker -->
    <div id="workout-tracker" style="display:none;">
        <h2>Current Workout</h2>
        <div id="current-exercise"></div>
        <div id="timer"></div>
        <button id="complete-set" onclick="completeSet()">Complete Set</button>
    </div>

    <!-- Workout History -->
    <div id="workout-history">
        <h2>Workout History</h2>
        <ul id="history-list"></ul>
        <button onclick="deleteSelectedHistory()">Delete Selected History</button>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.0.2/main.min.js"></script>
    <script>
        // Preset Exercises
        const presetExercises = [
            "Squats", "Rows", "Pulldowns", "Chest Press", "Shoulder Press",
            "Curls", "Tricep Extensions", "Deadlift", "Ham Curls", "Glute Thrusts"
        ];

        // Global Variables
        let workout = [];
        let history = JSON.parse(localStorage.getItem("history")) || [];
        let savedWorkouts = JSON.parse(localStorage.getItem("savedWorkouts")) || [];
        let currentExerciseIndex = 0;

        // Add Exercise Function
        function addExercise() {
            const exercisesDiv = document.getElementById("exercises");
            const exerciseDiv = document.createElement("div");
            exerciseDiv.classList.add("exercise");
            exerciseDiv.innerHTML = `
                <select class="preset">
                    <option value="">Custom</option>
                    ${presetExercises.map(ex => `<option value="${ex}">${ex}</option>`).join("")}
                </select>
                <input type="text" placeholder="Exercise Name" class="name" />
                <input type="number" placeholder="Sets" class="sets" />
                <div class="sets-reps"></div>
                <button onclick="addSetDetails(this)">Add Set Details</button>
            `;
            exercisesDiv.appendChild(exerciseDiv);

            // Auto-fill custom field if a preset is selected
            exerciseDiv.querySelector(".preset").addEventListener("change", function () {
                const customName = exerciseDiv.querySelector(".name");
                if (this.value) customName.value = this.value;
            });
        }

        // Add Set Details
        function addSetDetails(button) {
            const setsRepsDiv = button.previousElementSibling;
            const setCount = setsRepsDiv.childElementCount / 2 + 1;

            const setInput = document.createElement("div");
            setInput.innerHTML = `
                <input type="number" placeholder="Reps for Set ${setCount}" class="reps" />
                <input type="number" placeholder="Weight for Set ${setCount} (lbs)" class="weight" />
                <button onclick="removeSet(this)">Remove Set</button>
            `;
            setsRepsDiv.appendChild(setInput);
        }

        // Remove Set Details
        function removeSet(button) {
            button.parentElement.remove();
        }

        // Initialize First Exercise Bar
        function initializeFirstExercise() {
            const exercisesDiv = document.getElementById("exercises");
            exercisesDiv.innerHTML = "";
            addExercise();
        }

        // Save Workout
        function saveWorkout() {
            const workoutName = prompt("Enter a name for this workout:");
            if (!workoutName) return alert("Workout not saved. Please provide a name.");
            
            const exercisesDiv = document.querySelectorAll(".exercise");
            const newWorkout = [];
            exercisesDiv.forEach(exercise => {
                const name = exercise.querySelector(".name").value;
                const sets = parseInt(exercise.querySelector(".sets").value);
                const setDetails = Array.from(exercise.querySelectorAll(".reps, .weight")).map(input => ({
                    type: input.className,
                    value: parseInt(input.value),
                }));

                newWorkout.push({ name, sets, setDetails });
            });

            savedWorkouts.push({ name: workoutName, exercises: newWorkout });
            localStorage.setItem("savedWorkouts", JSON.stringify(savedWorkouts));
            loadSavedWorkouts();
        }

        // Load Saved Workouts
        function loadSavedWorkouts() {
            const workoutList = document.getElementById("workout-list");
            workoutList.innerHTML = savedWorkouts
                .map((workout, index) => `
                    <li>
                        <b>${workout.name}</b>
                        <button onclick="loadWorkout(${index})">Load</button>
                        <button onclick="deleteSavedWorkout(${index})">Delete</button>
                    </li>
                `).join("");
        }

        // Load Workout
        function loadWorkout(index) {
            const savedWorkout = savedWorkouts[index];
            workout = savedWorkout.exercises;
            startWorkout();
        }

        // Delete Saved Workout
        function deleteSavedWorkout(index) {
            savedWorkouts.splice(index, 1);
            localStorage.setItem("savedWorkouts", JSON.stringify(savedWorkouts));
            loadSavedWorkouts();
        }

        // Start Workout Function
        function startWorkout() {
            currentExerciseIndex = 0;

            if (workout.length > 0) {
                document.getElementById("workout-creator").style.display = "none";
                document.getElementById("workout-tracker").style.display = "block";
                loadNextExercise();
            } else {
                alert("Please create a workout before starting!");
            }
        }

        // Load Next Exercise
        function loadNextExercise() {
            if (currentExerciseIndex >= workout.length) {
                endWorkout();
                return;
            }

            const exercise = workout[currentExerciseIndex];
            const currentReps = exercise.setDetails[currentExerciseIndex]?.value || "N/A";
            const currentWeight = exercise.setDetails[currentExerciseIndex]?.value || "N/A";

            document.getElementById("current-exercise").innerHTML = `
                <p><b>Exercise:</b> ${exercise.name}</p>
                <p><b>Set:</b> ${currentExerciseIndex + 1}/${exercise.sets}</p>
                <p><b>Reps:</b> ${currentReps}</p>
                <p><b>Weight:</b> ${currentWeight} lbs</p>
            `;
        }

        // Complete Set
        function completeSet() {
            const exercise = workout[currentExerciseIndex];
            currentExerciseIndex++;

            if (currentExerciseIndex >= workout.length) {
                endWorkout();
            } else {
                loadNextExercise();
            }
        }

        // End Workout
        function endWorkout() {
            const feedback = prompt("How did you feel? Rate 1-5:");

            if (feedback && feedback >= 1 && feedback <= 5) {
                const workoutEndTime = new Date();
                history.push({
                    workout,
                    feedback,
                    date: new Date().toISOString(),
                    startTime: workout[0].startTime,
                    endTime: workoutEndTime.toLocaleTimeString([], { hour: "2-digit", minute: "2-digit" }),
                });
                localStorage.setItem("history", JSON.stringify(history));
            }

            workout = [];
            currentExerciseIndex = 0;

            alert("Workout complete!");
            document.getElementById("workout-creator").style.display = "block";
            document.getElementById("workout-tracker").style.display = "none";
            loadHistory();
        }

        // Delete Selected History
        function deleteSelectedHistory() {
            const historyIndex = prompt("Enter the index of the history to delete (e.g., 1, 2, 3):");
            if (!historyIndex || isNaN(historyIndex) || historyIndex < 1 || historyIndex > history.length) {
                return alert("Invalid index. Please try again.");
            }

            history.splice(historyIndex - 1, 1);
            localStorage.setItem("history", JSON.stringify(history));
            loadHistory();
        }

        // Load Workout History
        function loadHistory() {
            const historyList = document.getElementById("history-list");
            historyList.innerHTML = history
                .map((entry, index) => `
                    <li>
                        <b>${index + 1}. Date:</b> ${entry.date.split("T")[0]}<br>
                        <b>Feedback:</b> ${entry.feedback}<br>
                        <b>Exercises:</b>
                        <ul>${entry.workout.map(ex => `
                            <li>${ex.name} - ${ex.sets} sets, Weights: ${ex.setDetails.map(sd => sd.value).join(", ")}</li>
                        `).join("")}</ul>
                    </li>
                `).join("");
        }

        // Initialize
        document.addEventListener("DOMContentLoaded", () => {
            initializeFirstExercise();
            loadHistory();
            loadSavedWorkouts();
        });
    </script>
</body>
</html>
